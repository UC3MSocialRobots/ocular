<launch>

    <arg name="fixed_frame" value="camera_depth_frame" />
    <param name="robot_description" command="$(find xacro)/xacro.py '$(find pi_tracker)/urdf/pi_robot.urdf.xacro'" />
    <param name="/use_sim_time" value="False" />

    <node name="robot_state_publisher" pkg="robot_state_publisher" type="state_publisher">
    <param name="publish_frequency" value="20.0"/>
    </node>

<!--    <include file="$(find openni_launch)/launch/kinect_frames.launch" />-->

    <include file="$(find openni_launch)/launch/openni.launch">
        <arg name="depth_registration" value="false" />
    </include>

    <node name="skeleton_tracker" pkg="pi_tracker" type="skeleton_tracker">
    <param name="fixed_frame" value="$(arg fixed_frame)" />
    <param name="load_filepath" value="$(find pi_tracker)/params/SamplesConfigNewOpenNI.xml" />
    </node>

<!--	CONVERTER NODE: -->
    <node pkg="TFG" type="converter" name="converter" args="skeleton:=/skeleton hand_location:=/TFG/CONVERTER/hand_location"/>
    
<!--    ROI SEGMENTER -->

<!--			3D-->
    <node pkg="TFG" type="roi_segmenter3D"  name="roi_segmenter3D" args="original_pc:=/camera/depth/points hand_location:=/TFG/CONVERTER/hand_location segmented_pc:=/TFG/ROI3D/segmented_pc segmented_coordinates_px:=/TFG/ROI3D/segmented_coordinates_px"/>
    
<!--    		2D-->
    <node pkg="TFG" type="roi_segmenter2D"  name="roi_segmenter2D" args="original_image:=/camera/rgb/image_color segmented_coordinates_px:=/TFG/ROI3D/segmented_coordinates_px segmented_image:=/TFG/ROI2D/segmented_image"/>
    

<!--	FEATURE EXTRACTOR-->

<!--    		2D-->
	<node pkg="TFG" type="featureextractor2D" name="featureextractor2D" args="segmented_image:=/TFG/ROI2D/segmented_image descriptors2D:=/TFG/FE2D/descriptors2D"/>
		
<!--    		3D-->
	<node pkg="TFG" type="featureextractor3D" name="featureextractor3D" args="segmented_pc:=/TFG/ROI3D/segmented_pc"/>
	
<!--	TRAINER-->
	<node pkg="TFG" type="trainer" name="trainer" args="descriptors2D:=/TFG/FE2D/descriptors2D"/>
	
<!--	RECOGNIZER-->
	<node pkg="TFG" type="recognizer" name="recognizer" args="descriptors2D:=/TFG/FE2D/descriptors2D object_id:=/TFG/object_id"/>
	
<!--	EVENT HANDLER-->
	<node pkg="TFG" type="event_handler" name="event_handler" args="event:=/TFG/EVENTHANDLER/event skeleton:=/skeleton"/>






<!--	VIEW IMAGES-->
<!--    <node pkg="TFG" type="image_view"  name="viewer_ROI2D" args="image_in:=/TFG/ROI2D image_right_hand:=/TFG/image_right_hand image_left_hand:=/TFG/image_left_hand"/>-->
<!--    -->
<!--   	<node pkg="image_view" type="image_view"  name="image_view_l" args="image:=/TFG/image_left_hand"/>-->
<!--   	<node pkg="image_view" type="image_view"  name="image_view_r" args="image:=/TFG/image_right_hand"/>-->
<!--	KINECT IMAGE-->
<!--    <node pkg="image_view" type="image_view"  name="kinect_image" args="image:=/camera/rgb/image_color"/>-->


</launch>
